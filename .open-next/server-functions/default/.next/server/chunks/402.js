exports.id=402,exports.ids=[402],exports.modules={6487:()=>{},8335:()=>{},9046:(a,b,c)=>{"use strict";async function d(a){let b=a.split("\n").filter(a=>a.trim()),c=[];for(let a=0;a<b.length;a++){let d=b[a].trim();if(!d||d.toLowerCase().includes("sno")&&d.toLowerCase().includes("name")||d.toLowerCase().includes("serial")||d.toLowerCase().includes("no.")||d.toLowerCase().includes("name")&&d.toLowerCase().includes("email")&&d.toLowerCase().includes("title"))continue;let e=function(a){let b=a.replace(/\s+/g," ").trim(),c=b.split(/\s{2,}/);if(c.length<4)return f(b);let d=parseInt(c[0])||1,e=c[1]||"",g=c[2]||"",h=c[3]||"",i=c[4]||"";return e&&g&&i&&g.includes("@")?{sno:d,name:e.trim(),email:g.trim(),title:h.trim(),company:i.trim()}:null}(d)||f(d);e&&c.push(e)}return c}async function e(a){try{console.log("Parsing CSV file:",a.name);let b=(await a.text()).split("\n").filter(a=>a.trim());console.log("CSV lines found:",b.length),console.log("First few lines:",b.slice(0,3));let c=[],d=!1,e=-1;for(let a=0;a<Math.min(5,b.length);a++){let c=b[a].toLowerCase();if(c.includes("name")&&c.includes("email")&&(c.includes("company")||c.includes("title"))){d=!0,e=a,console.log("Header found at line:",a+1);break}}let f=d?e+1:0;for(let a=f;a<b.length;a++){let d=b[a].trim();if(!d)continue;let e=function(a,b){try{let c=function(a){let b=[],c="",d=!1,e=!1;for(let f=0;f<a.length;f++){let g=a[f];if(e){c+=g,e=!1;continue}if("\\"===g){e=!0;continue}'"'===g?d=!d:","!==g||d?c+=g:(b.push(c.trim()),c="")}return b.push(c.trim()),b.map(a=>{let b=a.replace(/^["']+|["']+$/g,"");return b=b.trim()})}(a);if(console.log(`Line ${b} parts:`,c),c.length<3)return console.log(`Line ${b}: Insufficient parts (${c.length})`),null;let d=1,e="",f="",g="",h="";if(c.length>=5?(d=parseInt(c[0])||1,e=c[1]||"",f=c[2]||"",g=c[3]||"",h=c[4]||""):4===c.length?(e=c[0]||"",f=c[1]||"",g=c[2]||"",h=c[3]||""):3===c.length&&(e=c[0]||"",f=c[1]||"",h=c[2]||""),e=e.trim().replace(/^["']|["']$/g,""),f=f.trim().replace(/^["']|["']$/g,""),g=g.trim().replace(/^["']|["']$/g,""),h=h.trim().replace(/^["']|["']$/g,""),!e||e.length<2)return console.log(`Line ${b}: Invalid name: "${e}"`),null;if(!f||!f.includes("@")||!f.includes("."))return console.log(`Line ${b}: Invalid email: "${f}"`),null;if(!h||h.length<2)return console.log(`Line ${b}: Invalid company: "${h}"`),null;let i={sno:d,name:e,email:f,title:g||"Not specified",company:h};return console.log(`Line ${b}: Valid contact parsed:`,i),i}catch(a){return console.error(`Error parsing line ${b}:`,a),null}}(d,a+1);e&&(e.sno=c.length+1,c.push(e))}if(console.log("Parsed contacts:",c.length),0===c.length)throw Error("No valid contacts found in CSV file. Please check the format.");return c}catch(a){throw console.error("Error parsing CSV:",a),Error(`Failed to parse CSV file: ${a instanceof Error?a.message:"Unknown error"}`)}}function f(a){let b=a.replace(/\s+/g," ").trim().split(" "),c=b.findIndex(a=>a.includes("@")&&a.includes(".")&&!a.includes("http")&&!a.includes("www"));if(-1===c)return null;let d=b[c],e=1;b[0]&&!isNaN(Number(b[0]))&&(e=parseInt(b[0]));let f=b.slice(1,c).join(" "),g=b.slice(c+1),h="",i="";if(g.length>0){let a=g[g.length-1];["Technologies","Systems","Solutions","Ltd","Inc","Corp","Company","Group"].some(b=>a.includes(b)),h=a,i=g.slice(0,-1).join(" ")}return f&&d&&h?{sno:e,name:f.trim(),email:d.trim(),title:i.trim(),company:h.trim()}:null}async function g(a){throw Error("PDF.js not loaded")}async function h(a){try{let b=await a.arrayBuffer();try{let a=new TextDecoder("utf-8").decode(b);if(a.length>100&&a.includes(" ")&&!a.includes("\0"))return a}catch{}for(let a of["utf-8","latin1","ascii"])try{let c=new TextDecoder(a).decode(b);if(c.length>100&&c.includes(" ")&&!c.includes("\0"))return c}catch{continue}return new TextDecoder().decode(b)}catch(a){throw console.error("Error parsing PDF server-side:",a),Error("Failed to parse PDF file")}}c.d(b,{_j:()=>g,if:()=>d,mF:()=>e,sS:()=>h})}};